There's an odd bug I'm noticing... the sonar pings are not placed correctly.
It's like they are being taken relative to the robot frame rather than the
lab frame somewhere.
OK, fixed this. Display was showing previous scan.

The other problem is that the whole thing goes nuts when the robot leaves the
map area. Maybe just add walls around the boundary?

Ooh, the robot can go through walls! Need to fix this.

I think the flee threshold might be too high, it's very hard to enter the
pocket as is.
